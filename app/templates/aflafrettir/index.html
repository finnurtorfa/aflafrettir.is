{% extends "base.html" %}

{% block header %}
<header class="masthead">
  <div class="col-xs-12 col-sm-12 col-md-9 col-md-offset-1">
    <div id="carousel-example-captions" 
         class="carousel slide" 
         data-ride="carousel">
      {% if top_ads %}
      <ol class="carousel-indicators">
        {% for ad in top_ads %}
        <li data-target="#carousel-example-captions"
            data-slide-to="{{ loop.index0 }}" 
            class="{% if loop.first %}active{% endif %}">
        </li>
        {% endfor %}
      </ol><!-- ./carousel-indicators -->

      <div class="carousel-inner">
        {% for ad in top_ads %}
        <div class="item {% if loop.first %}active{% endif %}">
          {% if ad.url %} <a href="{{ ad.url }}" target="_blank">{% endif %}
          <img src="{{ url(ad.filename) }}" alt="Auglýsing">
          {% if ad.url %}</a>{% endif %}
        </div> <!-- ./item -->
        {% endfor %}
      </div> <!-- ./carousel-inner -->
      {% else %}
      <ol class="carousel-indicators">
        <li data-target="#carousel-example-captions" 
            data-slide-to="0" 
            class="active">
        </li>
      </ol>

      <div class="carousel-inner">
        <div class="item active">
          <img data-src="holder.js/1140x300/auto/#777:#7777" 
               alt="Laust auglýsingapláss">
          <div class="carousel-caption">
            <p>{{ _('Pláss fyrir auglýsing') }}</p>
          </div>
        </div> <!-- ./item -->
      </div> <!-- ./carousel-inner -->
      {% endif %}

      <a class="left carousel-control" href="#carousel-example-captions" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
      <a class="right carousel-control" href="#carousel-example-captions" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
      </a>
    </div> <!-- ./carousel-example-captions -->
  </div> <!-- ./col-xs-12 col-sm-12 col-md-9 col-md-offset-1 -->
</header>
{% endblock %}

{% block content_left %}
<div class="col-md-2">
  <div class="panel panel-default" id="content_left" data-affix-top="310">
    <div class="panel-heading">{{ _('Flokkar') }}</div>
    <div class="panel-body">
      <ul class="nav nav-stacked">
        <li><a href="{{ url_for('aflafrettir.category', cid=1, lang_code=lang_code) }}">{{ _('Almenn frétt') }}</a></li>
        {% for category in categories %}
          <li><a href="{{ url_for('aflafrettir.category', cid=category.id, lang_code=lang_code) }}">{% if not lang_code  %}{{ category.name }}{% else %}{{ category.name_en }}{% endif %}</a></li>
        {% endfor %}
      </ul>
      {% if left_ads %}
        {% for ad in left_ads %}
        {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}<img src="{{ url(ad.filename) }}" alt="Auglýsing">{% if ad.url %}</a>{% endif %}
        {% endfor %}
      {% else %}
      <img data-src="holder.js/150x150/auto/#777:#7777" alt="Laust auglýsingapláss">
      {% endif %}
    </div> <!-- ./panel-body -->
  </div> <!-- ./panel panel-default -->
</div> <!-- ./col-md-2 -->
{% endblock %}

{% block content_main %}
<div class="col-md-10" id="content_main">
  {% include "_warnings.html" %}

  <div class="panel">
    <div class="panel-heading">{{ _('Fréttir') }}</div> 
    <div class="panel-body">
      
    {% set ad_type = 1 %}
    {% for post in posts.items %}
    {% if loop.index0 is divisibleby(2) %}
    <div class="row">
    {% endif %}
      <div class="col-6 col-sm-6">
        <h2> {{ post.title }} </h2>
        <div class="wrap-text"> 
          <a href="{{ url_for('aflafrettir.post', title=slugify(post.title), pid=post.id, lang_code=lang_code) }}">
            <img src="{{ post.thumbnail }}" class="img-resize" alt="Generic image">
          </a>
          <p> {{ truncate(post.body, 300)|safe }} 
          </p>
        </div>
        <div class="row">
          <div class="col-12 col-sm-12">
            <p class="pull-right">
              <span class="label label-default">
                <a href="{{ url_for('aflafrettir.post', title=slugify(post.title), pid=post.id, lang_code=lang_code) }}">Lesa meira »</a> 
              </span>
            </p>
            <ul class="list-inline">
              <li><a href="{{ url_for('aflafrettir.post', title=slugify(post.title), pid=post.id, lang_code=lang_code) }}">Birt {{ post.distance_in_time }}</a></li>
              <li><a href="{{ url_for('aflafrettir.post', title=slugify(post.title), pid=post.id, lang_code=lang_code) }}"><i class="glyphicon glyphicon-comment"></i> </a><a href="{{ url_for('aflafrettir.post', title=slugify(post.title), pid=post.id, lang_code=lang_code) }}#disqus_thread">Álit</a></li>
            </ul>
          </div> <!-- ./col-12 col-sm-12 -->
        </div> <!-- ./row -->
      </div> <!-- ./col-6 col-sm-6 col-lg-4 -->
    {% if loop.index is divisibleby(2) %}
    </div> <!-- ./row -->
    {% endif %}

      {% if (loop.index+2) is divisibleby(4) %}
      <div class="row">
        {% if  main_lg and ad_type == 1 %}
          {% set ad = main_lg.pop() %}
          <div class="col-12 col-sm-12 ad-main">
            {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}<img src="{{ url(ad.filename) }}" alt="Auglýsing">{% if ad.url %}</a>{% endif %}
            {% set ad_type = 2 %}
          </div> <!-- ./col-12 col-sm-12 -->
        {% elif main_sm and ad_type == 2 %}
          {% for i in range(2) %}
            {% if main_sm %}
              <div class="col-6 col-sm-6 ad-main">
                {% set ad = main_sm.pop() %}
                {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}<img src="{{ url(ad.filename) }}" alt="Auglýsing">{% if ad.url %}</a>{% endif %}
              </div> <!-- ./col-6 col-sm-6 -->
            {% else %}
              <div class="col-6 col-sm-6 ad-main">
                <img data-src="holder.js/455x250/auto/#777:#7777" alt="Laust auglýsingapláss">
              </div> <!-- ./col-6 col-sm-6 -->
            {% endif %}
          {% endfor %}
          {% set ad_type = 1 %}
        {% elif main_lg and not main_sm and ad_type == 2 %}
          {% set ad = main_lg.pop() %}
          <div class="col-12 col-sm-12 ad-main">
            {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}<img src="{{ url(ad.filename) }}" alt="Auglýsing">{% if ad.url %}</a>{% endif %}
          </div> <!-- ./col-12 col-sm-12 -->
        {% elif main_sm and not main_lg and ad_type == 1 %}
          {% for i in range(2) %}
            {% if main_sm %}
              {% set ad = main_sm.pop() %}
              <div class="col-6 col-sm-6 ad-main">
                {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}<img src="{{ url(ad.filename) }}" alt="Auglýsing">{% if ad.url %}</a>{% endif %}
              </div> <!-- ./col-6 col-sm-6 -->
            {% else %}
              <div class="col-6 col-sm-6 ad-main">
                <img data-src="holder.js/455x250/auto/#777:#7777" alt="Laust auglýsingapláss">
              </div> <!-- ./col-6 col-sm-6 -->
            {% endif %}
          {% endfor %}
        {% elif ad_type == 1 %}
          <div class="col-12 col-sm-12 ad-main">
            <img data-src="holder.js/945x250/auto/#777:#7777" alt="Laust auglýsingapláss">
          </div> <!-- ./col-12 col-sm-12 -->
          {% set ad_type = 2 %}
        {% elif ad_type == 2 %}
          <div class="col-6 col-sm-6 ad-main">
            <img data-src="holder.js/455x250/auto/#777:#7777" alt="Laust auglýsingapláss">
          </div> <!-- ./col-6 col-sm-12 -->
          <div class="col-6 col-sm-6 ad-main">
            <img data-src="holder.js/455x250/auto/#777:#7777" alt="Laust auglýsingapláss">
          </div> <!-- ./col-6 col-sm-12 -->
          {% set ad_type = 1 %}
        {% endif %}
      </div> <!-- ./row -->
      {% endif %}
    {% endfor %}

    </div> <!-- ./panel-body -->

    <div class="panel-footer text-center">
      <ul class="pager">
        {% if request.endpoint == 'aflafrettir.index' %}
        <li {% if  not posts.has_prev %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, page=posts.page-1, lang_code=lang_code)}}">{% endif %}&laquo;{{ _('Fyrri síða') }}</a></li>
        <li {% if not posts.has_next %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, page=posts.page+1, lang_code=lang_code)}}">{% endif %}{{ _('Næsta síða') }} &raquo;</a></li>
        {% elif request.endpoint == 'aflafrettir.category' %}
        <li {% if  not posts.has_prev %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, cid=request.view_args['cid'], page=posts.page-1, lang_code=lang_code)}}">{% endif %}&laquo;{{ _('Fyrri síða') }}</a></li>
        <li {% if not posts.has_next %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, cid=request.view_args['cid'], page=posts.page+1, lang_code=lang_code)}}">{% endif %}{{ _('Næsta síða') }} &raquo;</a></li>
        {% elif request.endpoint == 'aflafrettir.results' %}
        <li {% if  not posts.has_prev %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, query=request.view_args['query'], page=posts.page-1, lang_code=lang_code)}}">{% endif %}&laquo; Fyrri síða</a></li>
        <li {% if not posts.has_next %}class="disabled"><a href="#">{% else %}><a href="{{url_for(request.endpoint, query=request.view_args['query'], page=posts.page+1, lang_code=lang_code)}}">{% endif %}{{ _('Næsta síða') }} &raquo;</a></li>
        {% endif %}
      </ul> <!-- ./pagination -->
    </div> <!-- ./panel-footer -->
  </div> <!-- ./panel -->
</div> <!-- ./col-md-7 -->
{% endblock %}

{% block adbar %}
  {% if right_ads %}
    {% for ad in right_ads %}
    {% if ad.url %}<a href="{{ ad.url }}" target="_blank">{% endif %}
      <img src="{{ url(ad.filename) }}" alt="Auglýsing">
    {% if ad.url %}</a>{% endif %}
    {% endfor %}
  {% else %}
  <img data-src="holder.js/250x300/auto/#555:#5555" alt="Auglýsing">
  {% endif %}
{% endblock %}

{% block footer_right %}
<div class="col-md-9">
  <p class="text-center"> <strong>Flokkar</strong><br><hr></p>
</div>

<ul class="list-inline">
  <li><a href="{{ url_for('aflafrettir.category', cid=1, lang_code=lang_code) }}">Almenn frétt</a></li>
  {% for category in categories %} 
  <li><a href="{{ url_for('aflafrettir.category', cid=category.id, lang_code=lang_code) }}">{{ category.name }}</a></li>
  {% endfor %}
</ul>
{% endblock %}

{% block disqus_comments %}
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'aflafrettir'; 

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>
{% endblock %}

